---
name: "OPSX: 続行"
description: 変更の作業を続ける - 次のアーティファクトを作成（実験的）
category: Workflow
tags: [workflow, artifacts, experimental]
---

次のアーティファクトを作成して変更の作業を続けます。

**入力**: `/opsx:continue`の後にオプションで変更名を指定（例：`/opsx:continue add-auth`）。省略した場合は会話のコンテキストから推測を試みます。曖昧または不明確な場合は、利用可能な変更を表示して選択を促す必要があります。

**手順**

1. **変更名が指定されていない場合、選択を促す**

   `openspec list --json`を実行して、最終更新日順にソートされた利用可能な変更を取得。**AskUserQuestionツール**を使用してユーザーに選択させます。

   最近更新された上位3-4件の変更をオプションとして提示し、以下を表示：
   - 変更名
   - スキーマ（`schema`フィールドがあればその値、なければ「spec-driven」）
   - 状態（例：「0/5 タスク」、「完了」、「タスクなし」）
   - 最終更新日時（`lastModified`フィールドから）

   最近更新された変更に「（推奨）」マークを付ける（ユーザーが続けたいものである可能性が高いため）。

   **重要**: 推測や自動選択をしない。必ずユーザーに選択させる。

2. **現在の状態を確認**
   ```bash
   openspec status --change "<name>" --json
   ```
   JSONをパースして現在の状態を理解。レスポンスには以下が含まれる：
   - `schemaName`: 使用中のワークフロースキーマ（例：「spec-driven」）
   - `artifacts`: 各アーティファクトとその状態（「done」、「ready」、「blocked」）の配列
   - `isComplete`: すべてのアーティファクトが完了しているかを示すブール値

3. **状態に基づいてアクション**:

   ---

   **すべてのアーティファクトが完了している場合（`isComplete: true`）**:
   - ユーザーを祝福
   - 使用したスキーマを含む最終状態を表示
   - 提案：「すべてのアーティファクトが作成されました！この変更を実装するか、アーカイブできます。」
   - 停止

   ---

   **作成準備ができているアーティファクトがある場合**（`status: "ready"`のアーティファクトがある）:
   - status出力から`status: "ready"`の最初のアーティファクトを選択
   - その指示を取得：
     ```bash
     openspec instructions <artifact-id> --change "<name>" --json
     ```
   - JSONをパース。主要なフィールド：
     - `context`: プロジェクトの背景（あなたへの制約 - 出力に含めない）
     - `rules`: アーティファクト固有のルール（あなたへの制約 - 出力に含めない）
     - `template`: 出力ファイルに使用する構造
     - `instruction`: スキーマ固有のガイダンス
     - `outputPath`: アーティファクトを書き込む場所
     - `dependencies`: コンテキストとして読む完了済みアーティファクト
   - **アーティファクトファイルを作成**:
     - コンテキストとして完了した依存ファイルを読む
     - `template`を構造として使用 - そのセクションを埋める
     - `context`と`rules`を制約として適用 - ファイルにコピーしない
     - 指示で指定された出力パスに書き込む
   - 何が作成され、何がアンロックされたかを表示
   - 1つのアーティファクト作成後に停止

   ---

   **準備ができているアーティファクトがない場合（すべてブロック）**:
   - 有効なスキーマではこれは起こらないはず
   - 状態を表示し、問題の確認を提案

4. **アーティファクト作成後、進捗を表示**
   ```bash
   openspec status --change "<name>"
   ```

**出力**

各呼び出し後、以下を表示：
- 作成されたアーティファクト
- 使用中のスキーマワークフロー
- 現在の進捗（N/M 完了）
- アンロックされたアーティファクト
- プロンプト：「`/opsx:continue`を実行して次のアーティファクトを作成」

**アーティファクト作成ガイドライン**

アーティファクトの種類と目的はスキーマによって異なります。`openspec instructions`の出力から`instruction`フィールドを使用して何を作成するか理解してください。

一般的なアーティファクトパターン：

**spec-drivenスキーマ**（proposal → specs → design → tasks）:
- **proposal.md**: 変更が不明確な場合はユーザーに尋ねる。Why、What Changes、Capabilities、Impactを記入。
  - Capabilitiesセクションは重要 - リストされた各機能にはspecファイルが必要。
- **specs/<capability>/spec.md**: proposalのCapabilitiesセクションにリストされた機能ごとに1つのspecを作成（変更名ではなく機能名を使用）。
- **design.md**: 技術的決定、アーキテクチャ、実装アプローチを文書化。
- **tasks.md**: 実装をチェックボックス付きタスクに分解。

他のスキーマについては、CLI出力の`instruction`フィールドに従ってください。

**ガードレール**
- 呼び出しごとに1つのアーティファクトを作成
- 新しいアーティファクトを作成する前に必ず依存アーティファクトを読む
- アーティファクトをスキップしたり順序を無視したりしない
- コンテキストが不明確な場合は、作成前にユーザーに尋ねる
- 進捗をマークする前にアーティファクトファイルが存在することを確認
- スキーマのアーティファクトシーケンスを使用し、特定のアーティファクト名を仮定しない
- **重要**: `context`と`rules`はあなたへの制約であり、ファイルの内容ではない
  - `<context>`、`<rules>`、`<project_context>`ブロックをアーティファクトにコピーしない
  - これらは何を書くかのガイドであり、出力に含めるべきではない
