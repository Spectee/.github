---
name: "OPSX: 新規作成"
description: 実験的なアーティファクトワークフローで新しい変更を開始
category: Workflow
tags: [workflow, artifacts, experimental]
---

実験的なアーティファクト駆動アプローチで新しい変更を開始します。

**入力**: `/opsx:new`の後の引数は変更名（ケバブケース）、またはユーザーが構築したい内容の説明です。

**手順**

1. **入力がない場合は、何を構築したいか尋ねる**

   **AskUserQuestionツール**（オープンエンド、プリセットオプションなし）を使用して尋ねます：
   > 「どのような変更を行いたいですか？構築または修正したい内容を説明してください。」

   説明からケバブケース名を導出します（例：「ユーザー認証を追加」→ `add-user-auth`）。

   **重要**: ユーザーが何を構築したいか理解せずに進めないでください。

2. **ワークフロースキーマを決定**

   ユーザーが明示的に別のワークフローを要求しない限り、デフォルトスキーマを使用します（`--schema`を省略）。

   **以下の場合のみ別のスキーマを使用:**
   - 特定のスキーマ名を指定 → `--schema <name>`を使用
   - 「ワークフローを表示」や「どんなワークフローがある」と聞かれた → `openspec schemas --json`を実行して選択させる

   **それ以外**: `--schema`を省略してデフォルトを使用。

3. **変更ディレクトリを作成**
   ```bash
   openspec new change "<name>"
   ```
   ユーザーが特定のワークフローを要求した場合のみ`--schema <name>`を追加。
   選択されたスキーマで`openspec/changes/<name>/`にスキャフォールドされた変更が作成されます。

4. **アーティファクトの状態を表示**
   ```bash
   openspec status --change "<name>"
   ```
   作成が必要なアーティファクトと準備完了のアーティファクト（依存関係が満たされている）を表示します。

5. **最初のアーティファクトの指示を取得**
   最初のアーティファクトはスキーマによって異なります。status出力で「ready」状態の最初のアーティファクトを見つけます。
   ```bash
   openspec instructions <first-artifact-id> --change "<name>"
   ```
   最初のアーティファクトを作成するためのテンプレートとコンテキストが出力されます。

6. **停止してユーザーの指示を待つ**

**出力**

手順完了後、以下をまとめます：
- 変更名と場所
- 使用するスキーマ/ワークフローとそのアーティファクトシーケンス
- 現在の状態（0/N アーティファクト完了）
- 最初のアーティファクトのテンプレート
- プロンプト：「最初のアーティファクトを作成する準備はできましたか？`/opsx:continue`を実行するか、この変更の内容を説明していただければ下書きを作成します。」

**ガードレール**
- まだアーティファクトを作成しない - 指示を表示するだけ
- 最初のアーティファクトテンプレートの表示以降は進めない
- 名前が無効（ケバブケースでない）場合は、有効な名前を尋ねる
- その名前の変更が既に存在する場合は、代わりに`/opsx:continue`の使用を提案
- デフォルト以外のワークフローを使用する場合は--schemaを渡す
